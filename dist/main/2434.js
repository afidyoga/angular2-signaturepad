"use strict";(self.webpackChunkangularlight=self.webpackChunkangularlight||[]).push([[2434],{32434:(A,g,n)=>{n.r(g),n.d(g,{StokObatModule:()=>I});var p=n(69808),m=n(8202),c=n(23007),d=n(65415),f=n(2454),Z=n.n(f),D=n(25900),b=n(15439),t=n(5e3),T=n(44151),S=n(55648),y=n(94554),h=n(50072),v=n(65620),U=n(33399);const _=function(){return[]};let O=(()=>{class s{constructor(e,a,o,i,r,l){this.modalService=e,this.ModulStokService=a,this.router=o,this.money=i,this.spinner=r,this.store=l,this.datatableElement=d.G,this.dtOptions={},this.dataObat=new D.U,this.btnDetail=!1,this.btnDelete=!1,this.btnEdit=!1,this.btnSetting=!1,this.btnAdd=!1,this.view=!1,this.getState=this.store.select("stok_obat")}ngOnInit(){this.spinner.show("spinner1");let e=JSON.parse(localStorage.getItem("currentUser"));e=e.menu_right,this.btnDetail=-1!=e.findIndex(a=>"IVISOB2"==a.kode),this.view=-1!=e.findIndex(a=>"IVISOB1"==a.kode),this.view||Z().fire("Warning","Anda tidak mempunyai akses halaman ini","warning").then(()=>{window.location.href="/"}),this.dtOptions=this.showDataTables(this.btnDetail),this.getState.subscribe(a=>{this.reloadTable=a.reloadTable,!0===this.reloadTable&&this.reLoadData()}),setTimeout(()=>{this.spinner.hide("spinner1")},400)}detail(e){this.router.navigate(["stok-obat/detail/"+e.id_obat+"/"+encodeURIComponent(e.nama_obat)])}reLoadData(){this.datatableElement.dtInstance.then(e=>{e.ajax.reload()})}showDataTables(e){let a=this;return{pageLength:10,serverSide:!0,processing:!0,order:[],ajax:(o,i)=>{this.ModulStokService.listDatatables(o).subscribe(r=>{i({draw:r.response.draw,recordsTotal:r.response.recordsTotal,recordsFiltered:r.response.recordsFiltered,data:r.response.data})})},columns:[{orderable:!1,searchable:!1,render:(o,i,r,l)=>l.row+1+l.settings._iDisplayStart},{data:"nama_obat"},{data:"stok"},{data:"ed_terdekat_unix",render:(o,i,r,l)=>null!=o?b(new Date(o)).format("DD-MM-YYYY"):"Expired"},{data:"harga_jual",render:(o,i,r,l)=>a.money.formatRupiah(o)},{orderable:!1,searchable:!1,render:(o,i,r,l)=>e?'<button class="btn btn-sm btn-info detail">Detail</button>':""}],rowCallback:(o,i,r)=>{const l=this;return $("td .detail",o).on("click",()=>{l.detail(i)}),o}}}ngOnDestroy(){document.body.classList.remove("jw-modal-open")}btnOpenModal(){this.modalService.open("modalFormContent")}modalClose(){this.modalService.close("modalFormContent")}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(T.Z),t.Y36(S.O),t.Y36(c.F0),t.Y36(y.r),t.Y36(h.t2),t.Y36(v.yh))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-view"]],viewQuery:function(e,a){if(1&e&&t.Gf(d.G,5),2&e){let o;t.iGM(o=t.CRH())&&(a.datatableElement=o.first)}},decls:30,vars:7,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","items","active_item"],[1,"text-center","mb-4"],[1,"row","clearfix"],[1,"col-xs-12","col-sm-12","col-md-12","col-lg-12"],[1,"card"],[1,"header"],[1,"body"],["width","100%","datatable","",1,"table","table-striped","table-bordered","table-sm",3,"dtOptions"],["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-clip-rotate-multiple",3,"name","fullScreen"],[2,"color","white"]],template:function(e,a){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2),t._UZ(3,"app-breadcrumb",3),t.qZA(),t.TgZ(4,"h3",4),t._uU(5,"Stok Obat"),t.qZA(),t.TgZ(6,"div",5)(7,"div",6)(8,"div",7),t._UZ(9,"div",8),t.TgZ(10,"div",9)(11,"table",10)(12,"thead")(13,"tr")(14,"th"),t._uU(15,"No"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Barang"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Stok"),t.qZA(),t.TgZ(20,"th"),t._uU(21,"ED Terdekat"),t.qZA(),t.TgZ(22,"th"),t._uU(23,"Harga Jual(per @)"),t.qZA(),t.TgZ(24,"td"),t._uU(25,"Aksi"),t.qZA()()(),t._UZ(26,"tbody"),t.qZA()()()()()(),t.TgZ(27,"ngx-spinner",11)(28,"p",12),t._uU(29," Loading... "),t.qZA()()()),2&e&&(t.xp6(3),t.Q6J("title","Stok Obat")("items",t.DdM(6,_))("active_item","View Stok Obat"),t.xp6(8),t.Q6J("dtOptions",a.dtOptions),t.xp6(16),t.Q6J("name","spinner1")("fullScreen",!0))},directives:[U.L,d.G,h.Ro],styles:[""]}),s})();var w=n(15861),k=n(93075);const M=function(){return[]},C=function(){return["../../../view"]},Y=[{path:"",redirectTo:"view",pathMatch:"full"},{path:"view",component:O},{path:"detail/:id/:obat",component:(()=>{class s{constructor(e,a,o,i,r,l,j,B){this.fb=e,this.modalService=a,this.spinner=o,this.MoneyService=i,this.ModulStokService=r,this.store=l,this.activatedRoute=j,this.router=B,this.datatableElement=d.G,this.dtOptions={},this.dtOptionsRiwayat={},this.dataStok=[],this.listBatch=[],this.listRiwayat=[],this.id_obat=null,this.obat="",this.getState=this.store.select("stok_obat")}ngOnInit(){var e=this;this.activatedRoute.params.subscribe(function(){var a=(0,w.Z)(function*(o){o&&(e.spinner.show("spinner1"),e.loadData(o.id),e.id_obat=o.id,e.obat=decodeURIComponent(o.obat),e.dtOptions=e.showDataTables(o.id),e.dtOptionsRiwayat=e.showDataTablesRiwayat(o.id))});return function(o){return a.apply(this,arguments)}}())}showDataTables(e){let a=this;return{pageLength:10,serverSide:!0,processing:!0,order:[],ajax:(o,i)=>{this.ModulStokService.getRiwayatBatch(e,o).subscribe(r=>{i({draw:r.response.draw,recordsTotal:r.response.recordsTotal,recordsFiltered:r.response.recordsFiltered,data:r.response.data}),this.spinner.hide("spinner1")})},columns:[{orderable:!1,searchable:!1,render:(o,i,r,l)=>l.row+1+l.settings._iDisplayStart},{data:"tgl_faktur_unix",render:(o,i,r,l)=>null!=o?b(new Date(o)).format("DD-MM-YYYY"):"-"},{data:"harga_beli",render:(o,i,r,l)=>a.money(o)},{data:"no_batch"},{data:"tanggal_ed_unix",render:(o,i,r,l)=>null!=o?b(new Date(o)).format("DD-MM-YYYY"):"-"},{data:"stok_terkini"}],rowCallback:(o,i,r)=>{(new Date).getTime()>=new Date(i.tanggal_ed_unix).getTime()&&$(o).children().css("background-color","#ff8c8c")}}}showDataTablesRiwayat(e){return{pageLength:10,serverSide:!0,processing:!0,order:[],ajax:(a,o)=>{this.ModulStokService.getRiwayat(e,a).subscribe(i=>{o({draw:i.response.draw,recordsTotal:i.response.recordsTotal,recordsFiltered:i.response.recordsFiltered,data:i.response.data})})},columns:[{orderable:!1,searchable:!1,render:(a,o,i,r)=>r.row+1+r.settings._iDisplayStart},{data:"tanggal_invoice_unix",render:(a,o,i,r)=>null!=a?b(new Date(a)).format("DD-MM-YYYY"):"-"},{data:"kegiatan"},{data:"nama_lengkap"},{data:"no_batch"},{data:"stok_masuk"},{data:"stok_keluar"},{data:"stok_akhir"}]}}editKatalog(e){this.router.navigate(["katalog-obat/katalog/edit-buat-baru/"+this.id_obat+"/stok_detail"])}loadData(e){var a=this;return(0,w.Z)(function*(){yield a.ModulStokService.show(e).subscribe(o=>{o.response&&(a.dataStok=o.response)})})()}money(e){return this.MoneyService.formatRupiah(parseInt(e))}toInt(e){return parseInt(e)}toString(e){return JSON.stringify(e)}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(k.qu),t.Y36(T.Z),t.Y36(h.t2),t.Y36(y.r),t.Y36(S.O),t.Y36(v.yh),t.Y36(c.gz),t.Y36(c.F0))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-detail"]],viewQuery:function(e,a){if(1&e&&t.Gf(d.G,5),2&e){let o;t.iGM(o=t.CRH())&&(a.datatableElement=o.first)}},decls:115,vars:19,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","items","active_item"],[1,"text-center","mb-4"],[1,"row","clearfix"],[1,"col-xs-12","col-sm-12","col-md-12","col-lg-12"],[1,"row"],[1,"col-6"],["type","button",1,"btn","btn-kembali","btn-lg","mb-3",3,"routerLink"],[1,"fas","fa-arrow-left"],[1,"col-6","text-end"],[1,"btn","btn-info",3,"click"],[1,"card"],[1,"header"],[1,"text-center","w100"],[1,"body"],["width","100%",1,"table-header-info","mb-3"],[1,"table","table-striped","table-bordered","table-sm","mb-3"],["width","100%","datatable","",1,"table","table-striped","table-bordered","table-sm",3,"dtOptions"],[1,"text-center"],["rowspan","2"],["colspan","2"],["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-clip-rotate-multiple",3,"name","fullScreen"],[2,"color","white"]],template:function(e,a){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2),t._UZ(3,"app-breadcrumb",3),t.qZA(),t.TgZ(4,"h3",4),t._uU(5,"Detail Obat"),t._UZ(6,"br"),t._uU(7),t.qZA(),t.TgZ(8,"div",5)(9,"div",6)(10,"div",7)(11,"div",8)(12,"button",9),t._UZ(13,"i",10),t._uU(14," Kembali"),t.qZA()(),t.TgZ(15,"div",11)(16,"button",12),t.NdJ("click",function(){return a.editKatalog(a.dataStok.id_obat)}),t._uU(17,"Update Harga"),t.qZA()()(),t.TgZ(18,"div",13)(19,"div",14),t._UZ(20,"h4",15),t.qZA(),t.TgZ(21,"div",16)(22,"table",17)(23,"tbody")(24,"tr")(25,"th"),t._uU(26," Stock Total "),t._UZ(27,"br"),t.TgZ(28,"h4")(29,"strong"),t._uU(30),t.qZA()()(),t.TgZ(31,"th"),t._uU(32," Stock Minimun "),t._UZ(33,"br"),t.TgZ(34,"h4")(35,"strong"),t._uU(36),t.qZA()()(),t.TgZ(37,"th"),t._uU(38," Rata-rata Jual "),t.TgZ(39,"h4")(40,"strong"),t._uU(41),t.qZA()()()()()(),t.TgZ(42,"h3"),t._uU(43,"Detail Harga"),t.qZA(),t.TgZ(44,"table",18)(45,"tbody")(46,"tr")(47,"td"),t._uU(48," Harga Jual "),t._UZ(49,"br"),t._uU(50),t.qZA(),t.TgZ(51,"td"),t._uU(52," Harga Pokok "),t._UZ(53,"br"),t._uU(54),t.qZA(),t.TgZ(55,"td"),t._uU(56," Margin "),t._UZ(57,"br"),t._uU(58),t.qZA()()()()()(),t.TgZ(59,"div",13)(60,"div",16)(61,"h4")(62,"strong"),t._uU(63,"Batch Pada Stock"),t.qZA()(),t.TgZ(64,"p"),t._uU(65,"Dalam Tablet"),t.qZA(),t.TgZ(66,"table",19)(67,"thead")(68,"tr")(69,"th"),t._uU(70,"No"),t.qZA(),t.TgZ(71,"th"),t._uU(72,"Tanggal Beli"),t.qZA(),t.TgZ(73,"th"),t._uU(74,"Harga Pokok"),t.qZA(),t.TgZ(75,"th"),t._uU(76,"No. Batch"),t.qZA(),t.TgZ(77,"th"),t._uU(78,"ED"),t.qZA(),t.TgZ(79,"th"),t._uU(80,"Stock"),t.qZA()()(),t._UZ(81,"tbody"),t.qZA()()(),t.TgZ(82,"div",13)(83,"div",16)(84,"h4")(85,"strong"),t._uU(86,"Riwayat Stock"),t.qZA()(),t.TgZ(87,"p"),t._uU(88,"Dalam Tablet"),t.qZA(),t.TgZ(89,"table",19)(90,"thead")(91,"tr",20)(92,"th",21),t._uU(93,"No"),t.qZA(),t.TgZ(94,"th",21),t._uU(95,"Waktu"),t.qZA(),t.TgZ(96,"th",21),t._uU(97,"Kegiatan"),t.qZA(),t.TgZ(98,"th",21),t._uU(99,"Oleh"),t.qZA(),t.TgZ(100,"th",21),t._uU(101,"Batch"),t.qZA(),t.TgZ(102,"th",22),t._uU(103,"Jumlah"),t.qZA(),t.TgZ(104,"th",21),t._uU(105,"Stock"),t.qZA()(),t.TgZ(106,"tr",20)(107,"td"),t._uU(108,"Masuk"),t.qZA(),t.TgZ(109,"td"),t._uU(110,"Keluar"),t.qZA()()(),t._UZ(111,"tbody"),t.qZA()()()()()(),t.TgZ(112,"ngx-spinner",23)(113,"p",24),t._uU(114," Loading... "),t.qZA()()()),2&e&&(t.xp6(3),t.Q6J("title","Stock Obat")("items",t.DdM(17,M))("active_item","Detail Obat"),t.xp6(4),t.Oqu(a.obat),t.xp6(5),t.Q6J("routerLink",t.DdM(18,C)),t.xp6(18),t.hij(" ",a.dataStok.stok+" "+a.dataStok.kemasan_singkatan," "),t.xp6(6),t.AsE("",null!=a.dataStok.stok_minimum?a.dataStok.stok_minimum:"0"," ",a.dataStok.kemasan_singkatan," "),t.xp6(5),t.AsE(" ",null!=a.dataStok.rata_rata_jual?a.dataStok.rata_rata_jual:"0"," ",a.dataStok.kemasan_singkatan+"/mgg"," "),t.xp6(9),t.hij(" ",a.money(a.dataStok.harga_jual)+"/"+a.dataStok.kemasan_singkatan," "),t.xp6(4),t.hij(" ",a.money(a.dataStok.harga_pokok_terkini)+"/"+a.dataStok.kemasan_singkatan," "),t.xp6(4),t.hij(" ",a.dataStok.margin+"%"," "),t.xp6(8),t.Q6J("dtOptions",a.dtOptions),t.xp6(23),t.Q6J("dtOptions",a.dtOptionsRiwayat),t.xp6(23),t.Q6J("name","spinner1")("fullScreen",!0))},directives:[U.L,c.rH,d.G,h.Ro],styles:["table.table-header-info[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{text-align:center;padding:2px;width:10%}"]}),s})()}];let x=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[c.Bz.forChild(Y)],c.Bz]}),s})();var R=n(60795),q=n(16270),J=n(36642),E=n(34841),F=n(21023);let I=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[p.ez,x,R.K,h.ef,d.T,k.u5,k.UX,q.z,m.Ud,v.Aw.forFeature("stok_obat",E.o),J.sQ.forFeature([F.l])]]}),s})()},16270:(A,g,n)=>{n.d(g,{z:()=>c});var p=n(69808),m=n(5e3);let c=(()=>{class d{}return d.\u0275fac=function(Z){return new(Z||d)},d.\u0275mod=m.oAB({type:d}),d.\u0275inj=m.cJS({imports:[[p.ez]]}),d})()}}]);