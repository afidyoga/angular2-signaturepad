"use strict";(self.webpackChunkangularlight=self.webpackChunkangularlight||[]).push([[2315],{65674:(Z,_,o)=>{o.r(_),o.d(_,{KunjunganBulananModule:()=>Y});var g=o(69808),p=o(65415),h=o(23007),r=o(93075),b=o(15439),t=o(5e3),m=o(39870),d=o(18757),s=o(50072),v=o(156),f=o(33399),c=o(67236);function w(i,u){1&i&&(t.TgZ(0,"div",29),t._uU(1," Bulan rekap tidak boleh kosong "),t.qZA())}const U=function(){return[]},T=function(){return{dateInputFormat:"MM/YYYY"}},A=function(){return["Kunjungan Bulanan"]},y=function(){return["../../../../view"]},D=[{path:"",redirectTo:"view",pathMatch:"full"},{path:"view",component:(()=>{class i{constructor(e,n,a,l,k,S){this.fb=e,this.laporan=n,this.laporanExport=a,this.router=l,this.spinner=k,this.DaftarPoliklinikService=S,this.datatableElement=p.G,this.dtOptions={},this.formInput=null,this.listPoliklinik=[],this.search=!1,this.listKunjungan=[],this.tableShow=!1,this.currentUser=localStorage.getItem("currentUser")}ngOnInit(){this.spinner.show("spinner1"),this.currentUser=null!=this.currentUser?JSON.parse(this.currentUser):null,this.params={Authorization:this.currentUser.token,x_api_key:this.currentUser.key,search:{value:"",regex:!1},transaksi_jenis:"masuk",start:"",end:"",expired_in:0},this.formInput=this.fb.group({date_month:[new Date,[r.kI.required]],jenis_pasien:["",[r.kI.required]],id_poliklinik:["all",[]]}),this.DaftarPoliklinikService.getByAkunKlinik().subscribe(e=>{"0000"==e.metaData.response_code&&(this.listPoliklinik=e.response,this.spinner.hide("spinner1"))}),this.dtOptions=this.showDataTables()}convertTime(e){let n=new Date(e);e=new Date(n.getFullYear(),n.getMonth(),1);let a=b(e).format("YYYY-MM-DD")+" 00:00:00";return new Date(a).getTime()}reLoadData(){this.DaftarPoliklinikService.getByAkunKlinik().subscribe(e=>{"0000"==e.metaData.response_code&&(this.listPoliklinik=e.response)}),this.datatableElement.dtInstance.then(e=>{e.ajax.reload(),this.search=!1})}searchAction(){if(this.search=!0,this.formInput.invalid)return!1;this.reLoadData()}download(e){const n=window.URL.createObjectURL(new Blob([e],{type:"application/ms-excel"})),a=document.createElement("a");a.href=n,a.setAttribute("download","Laporan Kunjungan Bulanan.xlsx"),document.body.appendChild(a),a.click()}export(){this.spinner.show("spinner1"),this.search=!0,this.params.date_month=new Date(this.formInput.value.date_month).getTime(),this.params.jenis_pasien=""!=this.formInput.value.jenis_pasien?this.formInput.value.jenis_pasien:"all",this.params.id_poliklinik=this.formInput.value.id_poliklinik,this.laporanExport.exportBulanan(this.params).subscribe(e=>{this.download(e),this.search=!1,this.spinner.hide("spinner1")})}showDataTables(){return this.spinner.show("spinner1"),this.tableShow=!0,{pageLength:10,serverSide:!0,processing:!0,order:[],ajax:(e,n)=>{e.date_month=this.convertTime(this.formInput.value.date_month),this.laporan.getBulanan(e).subscribe(a=>{n({draw:a.response.draw,recordsTotal:a.response.recordsTotal,recordsFiltered:a.response.recordsFiltered,data:a.response.data}),this.spinner.hide("spinner1")})},columns:[{orderable:!1,searchable:!1,render:(e,n,a,l)=>l.row+1+l.settings._iDisplayStart},{data:"nama_poliklinik"},{data:"pasien_bpjs"},{data:"pasien_reguler"},{data:"total_pasien"},{orderable:!1,searchable:!1,render:(e,n,a,l)=>'<button class="btn btn-sm btn-info detail">Detail</button>'}],rowCallback:(e,n,a)=>{const l=this;return $("td .detail",e).on("click",()=>{l.detail(n)}),e}}}detail(e){this.router.navigate(["laporan/kunjungan-bulanan/detail/"+e.id_poliklinik+"/"+e.nama_poliklinik+"/"+this.convertTime(this.formInput.value.date_month)])}onOpenCalendar(e){e.monthSelectHandler=n=>{e._store.dispatch(e._actions.select(n.date))},e.setViewMode("month")}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(r.qu),t.Y36(m.Z),t.Y36(d.u),t.Y36(h.F0),t.Y36(s.t2),t.Y36(v.r))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-view"]],viewQuery:function(e,n){if(1&e&&t.Gf(p.G,5),2&e){let a;t.iGM(a=t.CRH())&&(n.datatableElement=a.first)}},decls:57,vars:13,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","items","active_item"],[1,"text-center","mb-4"],[1,"row","clearfix"],[1,"col-xs-12","col-sm-12","col-md-12","col-lg-12"],[1,"card"],[1,"header"],[1,"body"],[3,"formGroup"],[1,"row"],[1,"col-sm-2","col-form-label","fw-bold"],[1,"col-sm-8"],["type","text","formControlName","date_month","placeholder","Pilih Bulan Rekap","bsDatepicker","","autocomplete","off",1,"form-control",3,"bsConfig","onShown"],["class","form-text text-danger",4,"ngIf"],[1,"col-sm-9","offset-md-2"],["type","button",1,"btn","btn-md","btn-tampilkan-cari",3,"click"],[1,"fa","fa-download"],["type","button",1,"btn","btn-md","btn-primary",3,"click"],[1,"fa","fa-search"],["datatable","","width","100%",1,"table","table-striped","table-bordered","table-sm","table-sm",3,"dtOptions"],[1,"text-center"],["rowspan","2"],["colspan","2"],[1,"odd"],["valign","top","colspan","6",1,"dataTables_empty"],["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-clip-rotate-multiple",3,"name","fullScreen"],[2,"color","white"],[1,"form-text","text-danger"]],template:function(e,n){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2),t._UZ(3,"app-breadcrumb",3),t.qZA(),t.TgZ(4,"h3",4),t._uU(5,"Laporan Kunjungan Bulanan"),t.qZA(),t.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"h2")(11,"strong"),t._uU(12,"Pencarian"),t.qZA()()(),t.TgZ(13,"div",9)(14,"form",10)(15,"div",11)(16,"label",12),t._uU(17,"Bulan Rekap"),t.qZA(),t.TgZ(18,"div",13)(19,"input",14),t.NdJ("onShown",function(l){return n.onOpenCalendar(l)}),t.qZA(),t.YNc(20,w,2,0,"div",15),t.qZA()(),t.TgZ(21,"div",11)(22,"div",16)(23,"button",17),t.NdJ("click",function(){return n.export()}),t._UZ(24,"i",18),t._uU(25," Excel"),t.qZA(),t.TgZ(26,"button",19),t.NdJ("click",function(){return n.reLoadData()}),t._UZ(27,"i",20),t._uU(28," Cari"),t.qZA()()()()()(),t.TgZ(29,"div",7),t._UZ(30,"div",8),t.TgZ(31,"div",9)(32,"table",21)(33,"thead")(34,"tr",22)(35,"th",23),t._uU(36,"No"),t.qZA(),t.TgZ(37,"th",23),t._uU(38,"Poliklinik"),t.qZA(),t.TgZ(39,"th",24),t._uU(40,"Jumlah Pasien"),t.qZA(),t.TgZ(41,"th",23),t._uU(42,"Total Pasien"),t.qZA(),t.TgZ(43,"th",23),t._uU(44,"Aksi"),t.qZA()(),t.TgZ(45,"tr",22)(46,"th"),t._uU(47,"Pasien Bpjs"),t.qZA(),t.TgZ(48,"th"),t._uU(49,"Pasien Reguler"),t.qZA()()(),t.TgZ(50,"tbody")(51,"tr",25)(52,"td",26),t._uU(53,"No data available in table"),t.qZA()()()()()()()()(),t.TgZ(54,"ngx-spinner",27)(55,"p",28),t._uU(56," Loading... "),t.qZA()()()),2&e&&(t.xp6(3),t.Q6J("title","Laporan")("items",t.DdM(11,U))("active_item","Laporan Kunjungan Bulanan"),t.xp6(11),t.Q6J("formGroup",n.formInput),t.xp6(5),t.ekj("border-danger",null==n.formInput.value.date_month&&n.search),t.Q6J("bsConfig",t.DdM(12,T)),t.xp6(1),t.Q6J("ngIf",null==n.formInput.value.date_month&&n.search),t.xp6(12),t.Q6J("dtOptions",n.dtOptions),t.xp6(22),t.Q6J("name","spinner1")("fullScreen",!0))},directives:[f.L,r._Y,r.JL,r.sg,r.Fj,c.Y5,r.JJ,r.u,c.Np,g.O5,p.G,s.Ro],styles:[""]}),i})()},{path:"detail/:id/:poliklinik/:date_month",component:(()=>{class i{constructor(e,n,a,l){this.activatedRoute=e,this.spinner=n,this.laporan=a,this.laporanExport=l,this.datatableElement=p.G,this.dtOptions={},this.id_poliklinik=null,this.date_month=null,this.month=null,this.poliklinik=null,this.currentUser=localStorage.getItem("currentUser")}ngOnInit(){this.currentUser=null!=this.currentUser?JSON.parse(this.currentUser):null,this.params={Authorization:this.currentUser.token,x_api_key:this.currentUser.key,search:{value:"",regex:!1},date_month:null,transaksi_jenis:"masuk",start:"",end:"",expired_in:0},this.activatedRoute.params.subscribe(e=>{e&&(this.id_poliklinik=e.id,this.poliklinik=e.poliklinik,this.date_month=e.date_month,this.params.date_month=e.date_month,this.month=b(new Date(parseInt(e.date_month))).format("MM-YYYY"),this.dtOptions=this.showDataTables(e.date_month))})}download(e){const n=window.URL.createObjectURL(new Blob([e],{type:"application/ms-excel"})),a=document.createElement("a");a.href=n,a.setAttribute("download","Detail Laporan Kunjungan Bulanan.xlsx"),document.body.appendChild(a),a.click()}export(){this.spinner.show("spinner1"),this.params.id_poliklinik=this.id_poliklinik,this.laporanExport.exportBulananDetail(this.params).subscribe(e=>{this.download(e),this.spinner.hide("spinner1")})}showDataTables(e){return this.spinner.show("spinner1"),{pageLength:10,serverSide:!0,processing:!0,order:[],ajax:(n,a)=>{n.id_poliklinik=this.id_poliklinik,n.date_month=e,this.laporan.getBulananDetail(n).subscribe(l=>{a({draw:l.response.draw,recordsTotal:l.response.recordsTotal,recordsFiltered:l.response.recordsFiltered,data:l.response.data}),this.spinner.hide("spinner1")})},columns:[{orderable:!1,searchable:!1,render:(n,a,l,k)=>k.row+1+k.settings._iDisplayStart},{data:"tanggal",render:(n,a,l,k)=>b(n).format("DD-MM-YYYY")},{data:"pasien_bpjs"},{data:"pasien_reguler"},{data:"total_pasien"}]}}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(h.gz),t.Y36(s.t2),t.Y36(m.Z),t.Y36(d.u))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-view"]],viewQuery:function(e,n){if(1&e&&t.Gf(p.G,5),2&e){let a;t.iGM(a=t.CRH())&&(n.datatableElement=a.first)}},decls:49,vars:11,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","items","active_item"],[1,"text-center","mb-4"],[1,"row","clearfix"],[1,"col-xs-12","col-sm-12","col-md-12","col-lg-12"],["type","button",1,"btn","btn-kembali","btn-lg","mb-3",3,"routerLink"],[1,"fas","fa-arrow-left"],[1,"card"],[1,"body"],[1,"row","mb-4"],[1,"col-sm-8"],[1,"row","mb-2"],[1,"col-md-3"],[1,"col-sm-9"],[1,"col-sm-4","text-right"],[1,"btn","btn-md","btn-tampilkan-cari",3,"click"],[1,"fa","fa-download"],["width","100%","datatable","",1,"table","table-striped","table-bordered","table-sm",3,"dtOptions"],[1,"text-center"],["rowspan","2"],["colspan","2"],["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-clip-rotate-multiple",3,"name","fullScreen"],[2,"color","white"]],template:function(e,n){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2),t._UZ(3,"app-breadcrumb",3),t.qZA(),t.TgZ(4,"h3",4),t._uU(5,"Detail Laporan Kunjungan Bulanan"),t.qZA(),t.TgZ(6,"div",5)(7,"div",6)(8,"button",7),t._UZ(9,"i",8),t._uU(10," Kembali"),t.qZA(),t.TgZ(11,"div",9)(12,"div",10)(13,"div",11)(14,"div",12)(15,"div",13)(16,"div",14),t._uU(17,"Nama Poli"),t.qZA(),t.TgZ(18,"div",15),t._uU(19),t.qZA()(),t.TgZ(20,"div",13)(21,"div",14),t._uU(22,"Periode Transaksi"),t.qZA(),t.TgZ(23,"div",15),t._uU(24),t.qZA()()(),t.TgZ(25,"div",16)(26,"button",17),t.NdJ("click",function(){return n.export()}),t._UZ(27,"i",18),t._uU(28," Excel"),t.qZA()()(),t.TgZ(29,"table",19)(30,"thead")(31,"tr",20)(32,"th",21),t._uU(33,"No"),t.qZA(),t.TgZ(34,"th",21),t._uU(35,"Poliklinik"),t.qZA(),t.TgZ(36,"th",22),t._uU(37,"Jumlah Pasien"),t.qZA(),t.TgZ(38,"th",21),t._uU(39,"Total Pasien"),t.qZA()(),t.TgZ(40,"tr",20)(41,"th"),t._uU(42,"Pasien Bpjs"),t.qZA(),t.TgZ(43,"th"),t._uU(44,"Pasien Reguler"),t.qZA()()(),t._UZ(45,"tbody"),t.qZA()()()()()(),t.TgZ(46,"ngx-spinner",23)(47,"p",24),t._uU(48," Loading... "),t.qZA()()()),2&e&&(t.xp6(3),t.Q6J("title","Laporan")("items",t.DdM(9,A))("active_item","Detail Laporan Kunjungan Bulanan"),t.xp6(5),t.Q6J("routerLink",t.DdM(10,y)),t.xp6(11),t.hij(": ",n.poliklinik,""),t.xp6(5),t.hij(": ",n.month,""),t.xp6(5),t.Q6J("dtOptions",n.dtOptions),t.xp6(17),t.Q6J("name","spinner1")("fullScreen",!0))},directives:[f.L,h.rH,p.G,s.Ro],styles:[""]}),i})()}];let j=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[h.Bz.forChild(D)],h.Bz]}),i})();var B=o(60795),C=o(24376);let Y=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[g.ez,j,B.K,p.T,r.u5,s.ef,r.UX,C.A0,c.kn.forRoot()]]}),i})()},76334:(Z,_,o)=>{o.d(_,{m:()=>h});var g=o(5e3),p=o(95305);let h=(()=>{class r{constructor(t){this.authService=t}getUrlModule(t){return this.authService.currentUserValue.repo.find(s=>s.key_repo==t).url_repo}list24Hours(t=60,m="05:00"){let d=this.generateHoursInterval(0,1440,t),s=d.findIndex(c=>c==m),v=d.slice(s,d.length-1),f=d.slice(0,s);return v.concat(f)}generateHoursInterval(t,m,d){const s=[];for(let c=0;t<1440&&!(t>m);c++){var v=Math.floor(t/60),f=t%60;s[c]=("0"+v%24).slice(-2)+":"+("0"+f).slice(-2),t+=d}return s}}return r.\u0275fac=function(t){return new(t||r)(g.LFG(p.e))},r.\u0275prov=g.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()}}]);