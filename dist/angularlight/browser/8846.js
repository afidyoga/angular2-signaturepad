"use strict";(self.webpackChunkangularlight=self.webpackChunkangularlight||[]).push([[8846],{86307:(se,k,d)=>{d.d(k,{m:()=>T});var v=d(5e3),S=d(95305);let T=(()=>{class f{constructor(b){this.authService=b}getUrlModule(b){return this.authService.currentUserValue.repo.find(x=>x.key_repo==b).url_repo}}return f.\u0275fac=function(b){return new(b||f)(v.LFG(S.e))},f.\u0275prov=v.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})()},48846:(se,k,d)=>{d.r(k),d.d(k,{StafModule:()=>ht});var v=d(69808),S=d(64035),T=d(65415),f=d(15439),C=d(2454),b=d.n(C),o=d(65620);const I=(0,o.PH)("[JADWAL_STAF] add initial",(0,o.Ky)()),E=(0,o.PH)("[JADWAL_STAF] add success",(0,o.Ky)()),L=(0,o.PH)("[JADWAL_STAF] add failure ",(0,o.Ky)()),M=(0,o.PH)("[JADWAL_STAF] update initial",(0,o.Ky)()),Y=(0,o.PH)("[JADWAL_STAF] update success",(0,o.Ky)()),q=(0,o.PH)("[JADWAL_STAF] update failure",(0,o.Ky)()),K=(0,o.PH)("[JADWAL_STAF] get byid initial",(0,o.Ky)()),V=(0,o.PH)("[JADWAL_STAF] get byid success",(0,o.Ky)()),N=(0,o.PH)("[JADWAL_STAF] get byid failure",(0,o.Ky)()),O=(0,o.PH)("[JADWAL_STAF] delete initial",(0,o.Ky)()),F=(0,o.PH)("[JADWAL_STAF] delete success",(0,o.Ky)()),B=(0,o.PH)("[JADWAL_STAF] delete failure",(0,o.Ky)()),be=(0,o.PH)("[JADWAL_STAF] clear data "),z=(0,o.PH)("[JADWAL_STAF] table data"),R=new Date,h=R.getDate(),m=R.getMonth(),g=R.getFullYear(),ve=[{id:"event1",title:"All Day Event",start:new Date(g,m,1,0,0),end:new Date(g,m,1,23,59),className:"fc-event-success",groupId:"work",details:"Her extensive perceived may any sincerity extremity. Indeed add rather may pretty see."},{id:"event2",title:"Break",start:new Date(g,m,h+28,16,0),end:new Date(g,m,h+29,20,0),allDay:!1,className:"fc-event-primary",groupId:"important",details:"Her extensive perceived may any sincerity extremity. Indeed add rather may pretty see. "},{id:"event3",title:"Shopping",start:new Date(g,m,h+4,12,0),end:new Date(g,m,h+4,20,0),allDay:!1,className:"fc-event-warning",groupId:"personal",details:"Her extensive perceived may any sincerity extremity. Indeed add rather may pretty see. "},{id:"event4",title:"Meeting",start:new Date(g,m,h+14,10,30),end:new Date(g,m,h+16,20,0),allDay:!1,className:"fc-event-success",groupId:"work",details:"Her extensive perceived may any sincerity extremity. Indeed add rather may pretty see."},{id:"event5",title:"Lunch",start:new Date(g,m,h,11,0),end:new Date(g,m,h,14,0),allDay:!1,className:"fc-event-primary",groupId:"important",details:"Her extensive perceived may any sincerity extremity. Indeed add rather may pretty see."},{id:"event6",title:"Meeting",start:new Date(g,m,h+2,12,30),end:new Date(g,m,h+2,14,30),allDay:!1,className:"fc-event-success",groupId:"work",details:"Her extensive perceived may any sincerity extremity. Indeed add rather may pretty see."},{id:"event7",title:"Birthday Party",start:new Date(g,m,h+17,19,0),end:new Date(g,m,h+17,19,30),allDay:!1,className:"fc-event-warning",groupId:"personal",details:"Her extensive perceived may any sincerity extremity. Indeed add rather may pretty see."},{id:"event8",title:"Go to Delhi",start:new Date(g,m,h+-5,10,0),end:new Date(g,m,h+-4,10,30),allDay:!1,className:"fc-event-danger",groupId:"travel",details:"Her extensive perceived may any sincerity extremity. Indeed add rather may pretty see."},{id:"event9",title:"Get To Gather",start:new Date(g,m,h+6,10,0),end:new Date(g,m,h+7,10,30),allDay:!1,className:"fc-event-info",groupId:"friends",details:"Her extensive perceived may any sincerity extremity. Indeed add rather may pretty see."},{id:"event10",title:"Collage Party",start:new Date(g,m,h+20,10,0),end:new Date(g,m,h+20,10,30),allDay:!1,className:"fc-event-info",groupId:"friends",details:"Her extensive perceived may any sincerity extremity. Indeed add rather may pretty see."}];var e=d(5e3),Se=d(44151),c=d(93075),we=d(89955),Te=d(86307),Ze=d(40520);let H=(()=>{class n{constructor(t,a){this.generalService=t,this.http=a,this.urlBaseName="jadwal-staff",this.URL_MODULE=this.generalService.getUrlModule(we.s.url_module.master)}getDataTables(t){return this.http.post(this.URL_MODULE+"/"+this.urlBaseName+"/get-datatables",t)}getCalender(t,a){return this.http.get(this.URL_MODULE+"/"+this.urlBaseName+"/get-kalender?tahun="+t+"&bulan="+a)}insert(t){return this.http.post(this.URL_MODULE+"/"+this.urlBaseName,t)}addGenerate(t){return this.http.post(this.URL_MODULE+"/"+this.urlBaseName+"-generate",t)}update(t,a){return this.http.put(this.URL_MODULE+"/"+this.urlBaseName+"/"+t,a)}show(t){return this.http.get(this.URL_MODULE+"/"+this.urlBaseName+"/get-byid/"+t)}delete(t,a){return this.http.delete(this.URL_MODULE+"/"+this.urlBaseName+"/"+t,{headers:{"Content-Type":"application/json"},body:a})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(Te.m),e.LFG(Ze.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var w=d(50072),Q=d(33399),P=d(4566),Ae=d(51693);const De=["calendar_ref"],ye=function(){return["../add"]};function ke(n,l){1&n&&(e.TgZ(0,"button",32),e._UZ(1,"i",33),e._uU(2," Tambah Baru"),e.qZA()),2&n&&e.Q6J("routerLink",e.DdM(1,ye))}function Je(n,l){if(1&n&&(e.TgZ(0,"div",34)(1,"h4")(2,"b"),e._uU(3),e.qZA()(),e.TgZ(4,"div",35)(5,"div",36),e._uU(6," Event "),e.qZA(),e.TgZ(7,"div",37),e._uU(8),e.qZA()(),e.TgZ(9,"div",35)(10,"div",36),e._uU(11," Start Date "),e.qZA(),e.TgZ(12,"div",37),e._uU(13),e.qZA()(),e.TgZ(14,"div",35)(15,"div",36),e._uU(16," End Date "),e.qZA(),e.TgZ(17,"div",37),e._uU(18),e.qZA()()()),2&n){const t=e.oxw();e.xp6(3),e.Oqu("libur"==t.detailEvent.groupId?"Libur":"Buka Praktik"),e.xp6(5),e.hij(" : ",t.detailEvent.title," "),e.xp6(5),e.hij(" : ",t.setDate(t.detailEvent.start)," "),e.xp6(5),e.hij(" : ",t.setDate(t.detailEvent.end)," ")}}function Ue(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"button",38),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.edit(i.detailEvent.id)}),e._uU(1,"Edit"),e.qZA()}}const je=function(){return[]};let Ce=(()=>{class n{constructor(t,a,i,s,r,u){this.modalService=t,this.fb=a,this.jadwalStaffService=i,this.router=s,this.spinner=r,this.store=u,this.datatableElement=T.G,this.dtOptions={},this.titleModal="",this.detailEvent=null,this.btnDetail=!1,this.btnDelete=!1,this.btnEdit=!1,this.btnSetting=!1,this.btnAdd=!1,this.view=!1,this.calendarOptions={headerToolbar:{left:"prev,next today",center:"title",right:null},customButtons:{createButton:{text:"Tambah Baru",click:()=>this.CreateNew()},next:{click:this.nextMonth.bind(this)},prev:{click:this.backMonth.bind(this)}},initialView:"dayGridMonth",weekends:!0,editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,select:this.handleDateSelect.bind(this),eventClick:this.handleEventClick.bind(this)},this.getState=this.store.select("pengaturanJadwal_jadwalStaf")}ngOnInit(){this.spinner.show("spinner1");let t=JSON.parse(localStorage.getItem("currentUser"));t=t.menu_right,this.btnAdd=this.btnDelete=this.btnEdit=-1!=t.findIndex(a=>"MGPJJS2"==a.kode),this.btnDetail=this.view=-1!=t.findIndex(a=>"MGPJJS1"==a.kode),this.view||b().fire("Warning","Anda tidak mempunyai akses halaman ini","warning").then(()=>{window.location.href="/"}),this.dtOptions=this.showDataTables(this.btnEdit),this.calendarEvents=ve,this.getState.subscribe(a=>{this.reloadTable=a.reloadTable,this.reloadTable&&this.reLoadData()}),this.loadCalender(),setTimeout(()=>{this.spinner.hide("spinner1")},600)}loadCalender(){const t=new Date;let a=parseInt(f(new Date(t)).format("M")),i=f(new Date(t)).format("YYYY");this.jadwalStaffService.getCalender(i,a).subscribe(s=>{if("0000"==s.metaData.response_code){let r=[];s.response.map((u,_)=>{r.push({id:u.id_jadwal_staff,start:u.start,end:u.end,title:u.title,className:"libur"==u.groupId?"bg-danger":"bg-info"})}),this.calendarOptions.events=r}})}CreateNew(){this.calendarApi=this.calendar_ref.getApi(),this.calendarOptions.events=this.calendarEvents,this.calendarApi.render()}buttonToday(t){console.log(t)}nextMonth(){this.calendarApi=this.calendar_ref.getApi();const t=this.calendarApi.view.calendar.currentData.currentDate;let a=parseInt(f(new Date(t)).format("M"))+1,i=f(new Date(t)).format("YYYY");this.jadwalStaffService.getCalender(i,a).subscribe(s=>{if("0000"==s.metaData.response_code){let r=[];s.response.map((u,_)=>{r.push({id:u.id_jadwal_staff,start:u.start,end:u.end,title:u.title,className:"libur"==u.groupId?"bg-danger":"bg-info"})}),this.calendarOptions.events=r}}),this.calendarApi.next()}backMonth(){this.calendarApi=this.calendar_ref.getApi();const t=this.calendarApi.view.calendar.currentData.currentDate;let a=parseInt(f(new Date(t)).format("M"))-1,i=f(new Date(t)).format("YYYY");this.jadwalStaffService.getCalender(i,a).subscribe(s=>{if("0000"==s.metaData.response_code){let r=[];s.response.map((u,_)=>{r.push({id:u.id_jadwal_staff,start:u.start,end:u.end,title:u.title,className:"libur"==u.groupId?"bg-danger":"bg-info"})}),this.calendarOptions.events=r}}),this.calendarApi.prev()}handleDateSelect(t){this.addNewEvent(t)}addNewEvent(t){console.log("selectInfo",t.row)}setDate(t){return f(new Date(t)).format("DD-MM-YYYY")}handleEventClick(t){this.eventClick(t.event)}eventClick(t){this.detailEvent=t,this.OpenModal()}edit(t){this.router.navigate(["pengaturan-jadwal","pengaturan-jadwal-staf","edit",t])}reLoadData(){this.datatableElement.dtInstance.then(t=>{t.ajax.reload()})}editData(t){this.router.navigate(["pengaturan-jadwal","pengaturan-jadwal-staf","edit",t.id_jadwal_staff])}nonAktif(t){b().fire({title:"Delete recurring event",html:'<div class=" mb-2 text-left"><input type="radio" checked value="this" name="eventOption" class="radio"> This event</div><div class=" mb-2 text-left"><input type="radio" value="this_after" name="eventOption" class="radio"> This and follow event</div><div class="w100 mb-2 text-left"><input type="radio" value="all" name="eventOption" class="radio"> All </div>',focusConfirm:!1,preConfirm:()=>$("[name='eventOption']").val(),showCancelButton:!0,allowOutsideClick:!1,confirmButtonText:"OK",cancelButtonText:"Cancel"}).then(a=>{if(a.isConfirmed){let i=a.value;b().fire({title:"Apakah anda yakin akan menghapus data ini ?",icon:"warning",showCancelButton:!0,allowOutsideClick:!1,confirmButtonText:"Ya, hapus saja!",cancelButtonText:"Tidak, Batalkan"}).then(s=>{s.isConfirmed&&(this.spinner.show("spinner1"),this.store.dispatch(O({id:t.id_jadwal_staff,payload:{type_delete:i}})),setTimeout(()=>{this.loadCalender(),this.spinner.hide("spinner1")},400))})}})}showDataTables(t){return{pageLength:10,serverSide:!0,processing:!0,order:[],ajax:(a,i)=>{this.jadwalStaffService.getDataTables(a).subscribe(s=>{i({draw:s.response.draw,recordsTotal:s.response.recordsTotal,recordsFiltered:s.response.recordsFiltered,data:s.response.data})})},columns:[{orderable:!1,searchable:!1,render:(a,i,s,r)=>r.row+1+r.settings._iDisplayStart},{data:"nama_staff"},{data:"kategori_jadwal"},{data:"nama_role"},{data:"tgl_kegiatan",render:(a,i,s,r)=>f(new Date(a)).format("DD-MM-YYYY")},{orderable:!1,searchable:!1,render:(a,i,s,r)=>t?'<div style="white-space: nowrap;">\n                      <button class="btn btn-sm btn-ubah update-data">Edit</button>\n                      <button class="btn nonaktif-data btn-hapus btn-sm">Hapus</button>\n                    <div>':""}],rowCallback:(a,i,s)=>{const r=this;return $("td .update-data",a).on("click",()=>{r.editData(i)}),$("td .nonaktif-data",a).on("click",()=>{r.nonAktif(i)}),a}}}OpenModal(){this.modalService.open("modalFormContent")}modalClose(){this.modalService.close("modalFormContent")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Se.Z),e.Y36(c.qu),e.Y36(H),e.Y36(S.F0),e.Y36(w.t2),e.Y36(o.yh))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-view"]],viewQuery:function(t,a){if(1&t&&(e.Gf(De,5),e.Gf(T.G,5)),2&t){let i;e.iGM(i=e.CRH())&&(a.calendar_ref=i.first),e.iGM(i=e.CRH())&&(a.datatableElement=i.first)}},decls:76,vars:11,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","items","active_item"],[1,"text-center","mb-4"],[1,"row","clearfix"],[1,"col-xs-12","col-sm-12","col-md-12","col-lg-12"],["type","button","class","btn btn-tambah btn-lg mb-3",3,"routerLink",4,"ngIf"],[1,"card"],[1,"header"],[1,"body"],[1,"row"],[1,"col-md-2","col-sm-12","p-l-30"],[1,"m-b-25"],[1,"filter-container","mb-3"],["type","checkbox","name","","id","","checked",""],[1,"label-color","bg-info"],[1,"label-color","bg-danger"],[1,"col-md-10","col-sm-12"],[3,"options"],["calendar_ref",""],["width","100%","datatable","",1,"table","table-striped","table-bordered","table-sm","table-sm",3,"dtOptions"],[1,"footer"],["id","modalFormContent"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["class","modal-body",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-danger",3,"click"],["class","btn btn-kembali","type","button",3,"click",4,"ngIf"],["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-clip-rotate-multiple",3,"name","fullScreen"],[2,"color","white"],["type","button",1,"btn","btn-tambah","btn-lg","mb-3",3,"routerLink"],[1,"fas","fa-plus"],[1,"modal-body"],[1,"row","mb-2"],[1,"col-3"],[1,"col-9"],["type","button",1,"btn","btn-kembali",3,"click"]],template:function(t,a){1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2),e._UZ(3,"app-breadcrumb",3),e.qZA(),e.TgZ(4,"h3",4),e._uU(5,"Pengaturan Jadwal Staf"),e.qZA(),e.TgZ(6,"div",5)(7,"div",6),e.YNc(8,ke,3,2,"button",7),e.TgZ(9,"div",8),e._UZ(10,"div",9),e.TgZ(11,"div",10)(12,"div",11)(13,"div",12),e._UZ(14,"div",13),e.TgZ(15,"p")(16,"b"),e._uU(17,"Kategori"),e.qZA()(),e.TgZ(18,"div",14)(19,"ul")(20,"li"),e._UZ(21,"input",15),e._uU(22," Buka Praktik "),e.qZA(),e.TgZ(23,"li"),e._UZ(24,"input",15),e._uU(25," Libur "),e.qZA()()(),e.TgZ(26,"p")(27,"b"),e._uU(28,"Label"),e.qZA()(),e.TgZ(29,"div",14)(30,"ul")(31,"li"),e._UZ(32,"label",16),e._uU(33," Buka Praktik "),e.qZA(),e.TgZ(34,"li"),e._UZ(35,"label",17),e._uU(36," Libur "),e.qZA()()()(),e.TgZ(37,"div",18),e._UZ(38,"full-calendar",19,20),e.qZA()()()()()(),e.TgZ(40,"div",5)(41,"div",6)(42,"div",8)(43,"div",9)(44,"h4"),e._uU(45,"Daftar Jadwal"),e.qZA()(),e.TgZ(46,"div",10)(47,"table",21)(48,"thead")(49,"tr")(50,"th"),e._uU(51,"No"),e.qZA(),e.TgZ(52,"th"),e._uU(53,"Nama Akun Staf"),e.qZA(),e.TgZ(54,"th"),e._uU(55,"Kategori"),e.qZA(),e.TgZ(56,"th"),e._uU(57,"Nama Ruang"),e.qZA(),e.TgZ(58,"th"),e._uU(59,"Tgl. Masuk"),e.qZA(),e.TgZ(60,"th"),e._uU(61,"Aksi"),e.qZA()()(),e._UZ(62,"tbody"),e.qZA()(),e._UZ(63,"div",22),e.qZA()()(),e.TgZ(64,"jw-modal",23)(65,"div",24)(66,"h4",25),e._uU(67,"Detail Event"),e.qZA()(),e.YNc(68,Je,19,4,"div",26),e.TgZ(69,"div",27)(70,"button",28),e.NdJ("click",function(){return a.modalClose()}),e._uU(71,"Close"),e.qZA(),e.YNc(72,Ue,2,0,"button",29),e.qZA()()(),e.TgZ(73,"ngx-spinner",30)(74,"p",31),e._uU(75," Loading... "),e.qZA()()()),2&t&&(e.xp6(3),e.Q6J("title","Pengaturan Jadwal")("items",e.DdM(10,je))("active_item","Pengaturan Jadwal Staf"),e.xp6(5),e.Q6J("ngIf",a.btnAdd),e.xp6(30),e.Q6J("options",a.calendarOptions),e.xp6(9),e.Q6J("dtOptions",a.dtOptions),e.xp6(21),e.Q6J("ngIf",null!=a.detailEvent),e.xp6(4),e.Q6J("ngIf",null!=a.detailEvent),e.xp6(1),e.Q6J("name","spinner1")("fullScreen",!0))},directives:[Q.L,v.O5,S.rH,P.woE,T.G,Ae.z,w.Ro],styles:[""]}),n})();class Z{}var X=d(44194),xe=d(88544),ee=d(72620),te=d(78568),A=d(24376),D=d(67236),G=d(53464);function Ie(n,l){if(1&n&&(e.TgZ(0,"ng-option",59),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.Q6J("value",t.id_akun),e.xp6(1),e.Oqu(t.nama_lengkap)}}function Ee(n,l){1&n&&(e.TgZ(0,"div",60),e._uU(1," Akun Staff tidak boleh kosong "),e.qZA())}function Le(n,l){1&n&&(e.TgZ(0,"div",60),e._uU(1," Kategori masuk tidak boleh kosong "),e.qZA())}function Me(n,l){1&n&&(e.TgZ(0,"div",60),e._uU(1," Tanggal masuk tidak boleh kosong "),e.qZA())}function Ye(n,l){1&n&&(e.TgZ(0,"div",13)(1,"label",14),e._uU(2,"Repeat On"),e.qZA(),e.TgZ(3,"div",61)(4,"div",62)(5,"div",63)(6,"label",64),e._UZ(7,"input",65),e._uU(8," Minggu "),e.qZA(),e.TgZ(9,"label",64),e._UZ(10,"input",66),e._uU(11," Senin "),e.qZA(),e.TgZ(12,"label",64),e._UZ(13,"input",67),e._uU(14," Selasa "),e.qZA(),e.TgZ(15,"label",64),e._UZ(16,"input",68),e._uU(17," Rabu "),e.qZA(),e.TgZ(18,"label",64),e._UZ(19,"input",69),e._uU(20," Kamis "),e.qZA(),e.TgZ(21,"label",64),e._UZ(22,"input",70),e._uU(23," Jumat "),e.qZA(),e.TgZ(24,"label",64),e._UZ(25,"input",71),e._uU(26," Sabtu "),e.qZA()()()()())}function qe(n,l){if(1&n&&(e.TgZ(0,"ng-option",59),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.Q6J("value",t.id_jadwal_sesi),e.xp6(1),e.Oqu(t.nama_sesi)}}function Ne(n,l){if(1&n&&(e.TgZ(0,"ng-option",59),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.Q6J("value",t.id_ruang),e.xp6(1),e.Oqu(t.nama_ruang)}}function Oe(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"tr",72),e.ynx(1,73),e.TgZ(2,"td",74),e._uU(3),e.qZA(),e.TgZ(4,"td",74),e._uU(5),e.qZA(),e.TgZ(6,"td",74)(7,"ng-select",75),e.NdJ("search",function(i){return e.CHM(t),e.oxw().prosesSelectDaftarRuang(i,"search")})("scrollToEnd",function(i){return e.CHM(t),e.oxw().prosesSelectDaftarRuang(i,"last_page")})("open",function(i){return e.CHM(t),e.oxw().prosesSelectDaftarRuang(i,"open")}),e.YNc(8,Ne,2,2,"ng-option",17),e.qZA()(),e.TgZ(9,"td",74),e._UZ(10,"timepicker",76),e.qZA(),e.TgZ(11,"td",74),e._UZ(12,"timepicker",77),e.qZA(),e.TgZ(13,"td",78)(14,"button",79),e.NdJ("click",function(){const s=e.CHM(t).index;return e.oxw().deleteDetailSesi(s)}),e._uU(15,"Hapus"),e.qZA()(),e.BQk(),e.qZA()}if(2&n){const t=l.$implicit,a=l.index,i=e.oxw();e.xp6(1),e.Q6J("formGroupName",a),e.xp6(2),e.Oqu(a+1),e.xp6(2),e.Oqu(t.value.nama_sesi),e.xp6(2),e.Q6J("virtualScroll",!0)("searchable",!0)("loading",i.loadingListDaftarRuang)("clearable",!0),e.xp6(1),e.Q6J("ngForOf",i.listDaftarRuang),e.xp6(2),e.Q6J("minuteStep",1)("showMeridian",!1),e.xp6(2),e.Q6J("minuteStep",1)("showMeridian",!1)}}function Fe(n,l){if(1&n&&(e.TgZ(0,"ul")(1,"li"),e._uU(2),e.qZA()()),2&n){const t=l.$implicit;e.xp6(2),e.AsE("",t.field," : ",t.message,"")}}function Be(n,l){if(1&n&&(e.TgZ(0,"div",80),e._uU(1),e.YNc(2,Fe,3,2,"ul",81),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.errorMessage.metaData.message," "),e.xp6(1),e.Q6J("ngForOf",t.errorMessage.response)}}const Re=function(){return["Pengaturan Jadwal Staff"]},He=function(){return["../view"]},ae=function(){return{adaptivePosition:!0,dateInputFormat:"DD-MM-YYYY",returnFocusToInput:!0}},Qe=function(n,l){return{"fa-spin fa-spinner pulse":n,"fa-check":l}};let Pe=(()=>{class n{constructor(t,a,i,s,r,u,_){this.akunService=t,this.validate=a,this.daftarRuangService=i,this.fb=s,this.spinner=r,this.jadwalSesiService=u,this.store=_,this.listStaff=[],this.listDaftarRuang=[],this.listJadwalSesi=[],this.tglSekarang=new Date,this.minDate=new Date,this.loadingListStaff=!1,this.loadingListDaftarRuang=!1,this.loadingListJadwalSesi=!1,this.paramStaff={last_data:0,get_data:10,search:""},this.paramDaftarRuang={last_data:0,get_data:10,search:""},this.paramJadwalSesi={last_data:0,get_data:10,search:""},this.submitted=!1,this.jadwalStaff=new Z,this.getState=this.store.select("pengaturanJadwal_jadwalStaf"),this.minDate.setDate(this.minDate.getDate()+1)}ngOnInit(){let t=f().add(1,"days").format("DD-MM-YYYY");this.formInput=this.fb.group({id_akun_staff:[null,[c.kI.required]],tgl_masuk:[t,[c.kI.required]],id_jadwal_sesi:[null,[]],repeat:["none",[]],repeat_number:[1,[]],repeat_date:["day",[]],repeat_on:this.fb.group({senin:[null],selasa:[null],rabu:[null],kamis:[null],jumat:[null],sabtu:[null],minggu:[null]}),kategori:[null,[c.kI.required]],end:["on"],end_on_date:[t],end_occurrences:[1],detail:this.fb.array([])}),this.getState.subscribe(a=>{this.errorMessage=a.errorMessage,this.submitButton=a.submitButton,this.isLoadingButton=a.isLoadingButton})}isNumber(t){return this.validate.Number(t)}onFocus(t){document.getElementById(t).click()}SubmitForm(){if(this.submitted=!1,setTimeout(()=>{this.submitted=!0},200),this.formInput.invalid)return;this.spinner.show("spinner1");let t=new Z;t.id_akun_staff=this.formInput.value.id_akun_staff,t.tgl_awal=f(this.formInput.value.tgl_masuk,"DD-MM-YYYY").format("YYYY-MM-DD"),t.tgl_end_type=this.formInput.value.end,t.repeat=this.formInput.value.repeat;let a=[];null!=this.formInput.value.repeat_on.minggu&&a.push(0),null!=this.formInput.value.repeat_on.senin&&a.push(1),null!=this.formInput.value.repeat_on.selasa&&a.push(2),null!=this.formInput.value.repeat_on.rabu&&a.push(3),null!=this.formInput.value.repeat_on.kamis&&a.push(4),null!=this.formInput.value.repeat_on.jumat&&a.push(5),null!=this.formInput.value.repeat_on.sabtu&&a.push(6),t.repeat_on_week=a,t.repeat_value=this.formInput.value.repeat_number,t.repeat_type=this.formInput.value.repeat_date,t.kategori_jadwal=this.formInput.value.kategori,t.tgl_end_on=f(this.formInput.value.end_on_date,"DD-MM-YYYY").format("YYYY-MM-DD");let i=Array();this.formInput.value.detail.forEach(s=>{i.push({id_jadwal_sesi:s.id_jadwal_sesi,jam_mulai:f(s.jam_mulai).format("HH:mm:ss"),jam_selesai:f(s.jam_selesai).format("HH:mm:ss"),id_ruang:s.id_ruang?s.id_ruang.toString():""})}),t.detail=i,this.store.dispatch(I({payload:t})),setTimeout(()=>{this.spinner.hide("spinner1")},400)}simpanDetailSesi(){let t=this.formInput.value.id_jadwal_sesi;if(t){let a=this.listJadwalSesi.findIndex(i=>i.id_jadwal_sesi==t);if(a>=0){let i=this.listJadwalSesi[a];this.formInput.controls.detail.push(this.fb.group({id_jadwal_sesi:[i.id_jadwal_sesi,[]],nama_sesi:[i.nama_sesi,[]],id_ruang:[null,[]],jam_mulai:[new Date("Tue Apr 26 2022 00:00:00"),[]],jam_selesai:[new Date("Tue Apr 26 2022 00:00:00"),[]]}))}}}deleteDetailSesi(t){this.formInput.get("detail").removeAt(t)}prosesSelectStaff(t,a){this.loadingListStaff=!0;let i=this.paramStaff;"search"==a?(this.listJadwalSesi=[],i.search=t.term,i.last_data=0):i.search="",i.last_data="last_page"==a?i.last_data+i.get_data:0,this.akunService.prosesSelectAkun(i,a,"staff").subscribe(s=>{this.loadingListStaff=!1,s&&(0==this.listStaff.length?this.listStaff=s.response:s.response.map(r=>{this.listStaff.findIndex(_=>_.id_akun_staff==r.id_akun_staff)<0&&this.listStaff.push(r)}))},s=>{this.loadingListStaff=!1})}prosesSelectDaftarRuang(t,a){this.loadingListDaftarRuang=!0;let i=this.paramDaftarRuang;"search"==a?(this.listDaftarRuang=[],i.search=t.term,i.last_data=0):i.search="",i.last_data="last_page"==a?i.last_data+i.get_data:0,this.daftarRuangService.prosesSelectDaftarRuang(i,a).subscribe(s=>{this.loadingListDaftarRuang=!1,s&&(0==this.listDaftarRuang.length?this.listDaftarRuang=s.response:s.response.map(r=>{this.listDaftarRuang.findIndex(_=>_.id_ruang==r.id_ruang)<0&&this.listDaftarRuang.push(r)}))},s=>{this.loadingListDaftarRuang=!1})}parseTime(t){var a=new Date,i=t.match(/(\d+)(?::(\d\d))?\s*(p?)/);return a.setHours(parseInt(i[1])+(i[3]?12:0)),a.setMinutes(parseInt(i[2])||0),a}prosesSelectJadwalSesi(t,a){this.loadingListJadwalSesi=!0;let i=this.paramJadwalSesi;"search"==a?(this.listJadwalSesi=[],i.search=t.term,i.last_data=0):i.search="",i.last_data="last_page"==a?i.last_data+i.get_data:0,this.jadwalSesiService.prosesSelectJadwalSesi(i,a).subscribe(s=>{this.loadingListJadwalSesi=!1,this.listJadwalSesi=[],s&&(0==this.listJadwalSesi.length?s.response.forEach(r=>{this.listJadwalSesi.push({id_jadwal_sesi:r.id_jadwal_sesi,nama_sesi:r.nama_sesi+" ("+f(this.parseTime(r.jam_buka)).format("HH:mm")+" - "+f(this.parseTime(r.jam_tutup)).format("HH:mm")+")"})}):s.response.map(r=>{this.listJadwalSesi.findIndex(_=>_.id_jadwal_sesi==r.id_jadwal_sesi)<0&&this.listJadwalSesi.push({id_jadwal_sesi:r.id_jadwal_sesi,nama_sesi:r.nama_sesi+" ("+f(this.parseTime(r.jam_buka)).format("HH:mm")+" - "+f(this.parseTime(r.jam_tutup)).format("HH:mm")+")"})}))},s=>{this.loadingListJadwalSesi=!1})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(X.f),e.Y36(xe.p),e.Y36(ee.d),e.Y36(c.qu),e.Y36(w.t2),e.Y36(te.l),e.Y36(o.yh))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add"]],decls:125,vars:45,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","items","active_item"],[1,"text-center","mb-4"],[1,"row","clearfix"],[1,"col-xs-12","col-sm-12","col-md-12","col-lg-12"],["type","button",1,"btn","btn-kembali","btn-lg","mb-3",3,"routerLink"],[1,"fas","fa-arrow-left"],[1,"card"],[3,"formGroup","submit"],[1,"header"],[1,"body"],[1,"row","mb-3"],[1,"col-sm-2","col-form-label","fw-bold"],[1,"col-sm-9"],["bindLabel","nama_lengkap","bindValue","id_akun","placeholder","Pilih akun staff","formControlName","id_akun_staff",2,"flex","1 1 auto",3,"virtualScroll","searchable","loading","clearable","search","scrollToEnd","open"],[3,"value",4,"ngFor","ngForOf"],["class","form-text text-danger",4,"ngIf"],["placeholder","Pilih kategori","formControlName","kategori",1,"form-control"],["value","masuk"],["value","libur"],[1,"input-group"],["type","text","bsDatepicker","","formControlName","tgl_masuk","placeholder","Tanggal Masuk","id","tgl2",1,"form-control",3,"bsConfig","outsideClick","minDate"],[1,"input-group-text",2,"cursor","pointer","background","white","border-left","0px",3,"click"],[1,"fa","fa-calendar"],[1,"row"],[1,"col-sm-2"],[1,"form-check","pt-2"],["type","radio","name","repeat","formControlName","repeat","value","none","id","flexRadioDefault2",1,"form-check-input"],["for","flexRadioDefault2",1,"form-check-label"],[1,"form-check"],["type","radio","name","repeat","formControlName","repeat","value","every",1,"form-check-input"],[1,"form-check-label"],["type","text","formControlName","repeat_number",1,"form-control",3,"keypress"],["formControlName","repeat_date",1,"form-select"],["value","day"],["value","week"],["value","month"],["class","row mb-3",4,"ngIf"],["type","radio","formControlName","end","value","on",1,"form-check-input"],["type","text","bsDatepicker","","formControlName","end_on_date","placeholder","Pilih tanggal","id","tgl1",1,"form-control",3,"readonly","bsConfig","outsideClick","minDate"],[1,"col-sm-3"],["type","radio","formControlName","end","value","never",1,"form-check-input"],[1,"col-sm-4"],["bindLabel","nama_sesi","bindValue","id_jadwal_sesi","placeholder","Pilih jadwal sesi","formControlName","id_jadwal_sesi",2,"flex","1 1 auto",3,"virtualScroll","searchable","loading","clearable","search","scrollToEnd","open"],["type","button",1,"btn","btn-simpan",3,"click"],[1,"fa","fa-plus"],[1,"m-3","row"],[1,"table","tabl-sm","table-striped","table-bordered","table-sm"],[1,"pb-3"],["formArrayName","detail",4,"ngFor","ngForOf"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"footer"],[1,"text-center","mb-3"],["type","submit","color","primary",1,"btn","btn-simpan","btn-lg",3,"disabled"],[1,"fa",3,"ngClass"],["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-clip-rotate-multiple",3,"name","fullScreen"],[2,"color","white"],[3,"value"],[1,"form-text","text-danger"],[1,"col-sm-8"],[1,"control-group","pt-2"],["formGroupName","repeat_on",1,"controls","span2"],[1,"checkbox","pe-3"],["type","checkbox","formControlName","minggu","value","0"],["type","checkbox","formControlName","senin","value","1"],["type","checkbox","formControlName","selasa","value","2"],["type","checkbox","formControlName","rabu","value","3"],["type","checkbox","formControlName","kamis","value","4"],["type","checkbox","formControlName","jumat","value","5"],["type","checkbox","formControlName","sabtu","value","6"],["formArrayName","detail"],[3,"formGroupName"],[1,"p-3",2,"vertical-align","top"],["bindLabel","nama_ruang","bindValue","id_ruang","placeholder","Pilih daftar ruang","formControlName","id_ruang",2,"flex","1 1 auto",3,"virtualScroll","searchable","loading","clearable","search","scrollToEnd","open"],["formControlName","jam_mulai",3,"minuteStep","showMeridian"],["formControlName","jam_selesai",3,"minuteStep","showMeridian"],[1,"p-3"],["type","button",1,"btn","btn-hapus",3,"click"],["role","alert",1,"alert","alert-danger"],[4,"ngFor","ngForOf"]],template:function(t,a){1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2),e._UZ(3,"app-breadcrumb",3),e.qZA(),e.TgZ(4,"h3",4),e._uU(5,"Tambah Pengaturan Jadwal Staff"),e.qZA(),e.TgZ(6,"div",5)(7,"div",6)(8,"button",7),e._UZ(9,"i",8),e._uU(10," Kembali"),e.qZA(),e.TgZ(11,"div",9)(12,"form",10),e.NdJ("submit",function(){return a.SubmitForm()}),e._UZ(13,"div",11),e.TgZ(14,"div",12)(15,"div",13)(16,"label",14),e._uU(17,"Staff *"),e.qZA(),e.TgZ(18,"div",15)(19,"ng-select",16),e.NdJ("search",function(s){return a.prosesSelectStaff(s,"search")})("scrollToEnd",function(s){return a.prosesSelectStaff(s,"last_page")})("open",function(s){return a.prosesSelectStaff(s,"open")}),e.YNc(20,Ie,2,2,"ng-option",17),e.qZA(),e.YNc(21,Ee,2,0,"div",18),e.qZA()(),e.TgZ(22,"div",13)(23,"label",14),e._uU(24,"Kategori *"),e.qZA(),e.TgZ(25,"div",15)(26,"select",19)(27,"option",20),e._uU(28,"Masuk"),e.qZA(),e.TgZ(29,"option",21),e._uU(30,"Libur"),e.qZA()(),e.YNc(31,Le,2,0,"div",18),e.qZA()(),e.TgZ(32,"div",13)(33,"label",14),e._uU(34,"Tgl Awal *"),e.qZA(),e.TgZ(35,"div",15)(36,"div",22),e._UZ(37,"input",23),e.TgZ(38,"span",24),e.NdJ("click",function(){return a.onFocus("tgl2")}),e._UZ(39,"i",25),e.qZA()(),e.YNc(40,Me,2,0,"div",18),e.qZA()(),e.TgZ(41,"div",26)(42,"label",14),e._uU(43,"Repeat"),e.qZA(),e.TgZ(44,"div",27)(45,"div",28),e._UZ(46,"input",29),e.TgZ(47,"label",30),e._uU(48," None "),e.qZA()()()(),e.TgZ(49,"div",13),e._UZ(50,"div",27),e.TgZ(51,"div",27)(52,"div",31),e._UZ(53,"input",32),e.TgZ(54,"label",33),e._uU(55," Every "),e.qZA()()(),e.TgZ(56,"div",27)(57,"input",34),e.NdJ("keypress",function(s){return a.isNumber(s)}),e.qZA()(),e.TgZ(58,"div",27)(59,"select",35)(60,"option",36),e._uU(61,"Day"),e.qZA(),e.TgZ(62,"option",37),e._uU(63,"Week"),e.qZA(),e.TgZ(64,"option",38),e._uU(65,"Month"),e.qZA()()()(),e.YNc(66,Ye,27,0,"div",39),e.TgZ(67,"div",26)(68,"div",14),e._uU(69,"End"),e.qZA(),e.TgZ(70,"div",27)(71,"div",31),e._UZ(72,"input",40),e.TgZ(73,"label",33),e._uU(74," On "),e.qZA()()(),e.TgZ(75,"div",27)(76,"div",22),e._UZ(77,"input",41),e.TgZ(78,"span",24),e.NdJ("click",function(){return a.onFocus("tgl1")}),e._UZ(79,"i",25),e.qZA()()()(),e.TgZ(80,"div",13),e._UZ(81,"label",27),e.TgZ(82,"div",42)(83,"div",31),e._UZ(84,"input",43),e.TgZ(85,"label",33),e._uU(86," Never (Max. 1 years) "),e.qZA()()()(),e.TgZ(87,"div",13)(88,"label",14),e._uU(89,"Jadwal Sesi"),e.qZA(),e.TgZ(90,"div",44)(91,"ng-select",45),e.NdJ("search",function(s){return a.prosesSelectJadwalSesi(s,"search")})("scrollToEnd",function(s){return a.prosesSelectJadwalSesi(s,"last_page")})("open",function(s){return a.prosesSelectJadwalSesi(s,"open")}),e.YNc(92,qe,2,2,"ng-option",17),e.qZA()(),e.TgZ(93,"div",27)(94,"button",46),e.NdJ("click",function(){return a.simpanDetailSesi()}),e._UZ(95,"i",47),e._uU(96," Tambah"),e.qZA()()(),e.TgZ(97,"div",48)(98,"table",49)(99,"thead",50)(100,"tr")(101,"th"),e._uU(102,"No"),e.qZA(),e.TgZ(103,"th"),e._uU(104,"Nama Jadwal Sesi"),e.qZA(),e.TgZ(105,"th"),e._uU(106,"Ruangan"),e.qZA(),e.TgZ(107,"th"),e._uU(108,"Jam Mulai"),e.qZA(),e.TgZ(109,"th"),e._uU(110,"Jam Selesai"),e.qZA(),e.TgZ(111,"th"),e._uU(112,"Aksi"),e.qZA()()(),e.TgZ(113,"tbody"),e.YNc(114,Oe,16,12,"tr",51),e.qZA()()(),e.TgZ(115,"div",13),e.YNc(116,Be,3,2,"div",52),e.qZA()(),e.TgZ(117,"div",53)(118,"div",54)(119,"button",55),e._UZ(120,"i",56),e._uU(121," Simpan "),e.qZA()()()()()()(),e.TgZ(122,"ngx-spinner",57)(123,"p",58),e._uU(124," Loading... "),e.qZA()()()()),2&t&&(e.xp6(3),e.Q6J("title","Pengaturan Jadwal")("items",e.DdM(38,Re))("active_item","Tambah Baru"),e.xp6(5),e.Q6J("routerLink",e.DdM(39,He)),e.xp6(4),e.Q6J("formGroup",a.formInput),e.xp6(7),e.ekj("border-danger",a.formInput.controls.id_akun_staff.hasError("required")&&a.submitted),e.Q6J("virtualScroll",!0)("searchable",!0)("loading",a.loadingListStaff)("clearable",!0),e.xp6(1),e.Q6J("ngForOf",a.listStaff),e.xp6(1),e.Q6J("ngIf",a.formInput.controls.id_akun_staff.hasError("required")&&a.submitted),e.xp6(5),e.ekj("border-danger",a.formInput.controls.kategori.hasError("required")&&a.submitted),e.xp6(5),e.Q6J("ngIf",a.formInput.controls.kategori.hasError("required")&&a.submitted),e.xp6(6),e.ekj("border-danger",a.formInput.controls.tgl_masuk.hasError("required")&&a.submitted),e.Q6J("bsConfig",e.DdM(40,ae))("outsideClick",!0)("minDate",a.minDate),e.xp6(3),e.Q6J("ngIf",a.formInput.controls.tgl_masuk.hasError("required")&&a.submitted),e.xp6(26),e.Q6J("ngIf","week"==a.formInput.value.repeat_date&&"every"==a.formInput.value.repeat),e.xp6(11),e.Q6J("readonly","on"!=a.formInput.value.end)("bsConfig",e.DdM(41,ae))("outsideClick",!0)("minDate",a.minDate),e.xp6(14),e.Q6J("virtualScroll",!0)("searchable",!0)("loading",a.loadingListJadwalSesi)("clearable",!0),e.xp6(1),e.Q6J("ngForOf",a.listJadwalSesi),e.xp6(22),e.Q6J("ngForOf",a.formInput.get("detail").controls),e.xp6(2),e.Q6J("ngIf",null!=a.errorMessage),e.xp6(3),e.Q6J("disabled",a.isLoadingButton),e.xp6(1),e.Q6J("ngClass",e.WLB(42,Qe,a.isLoadingButton,!a.isLoadingButton)),e.xp6(2),e.Q6J("name","spinner1")("fullScreen",!0))},directives:[Q.L,S.rH,c._Y,c.JL,c.sg,A.w9,c.JJ,c.u,v.sg,A.jq,v.O5,c.EJ,c.YN,c.Kr,D.Y5,c.Fj,D.Np,c._,c.x0,c.Wl,c.CE,G.EV,v.mk,w.Ro],styles:[".col-sm-3[_ngcontent-%COMP%], .col-sm-2[_ngcontent-%COMP%]{margin-bottom:5px!important}"]}),n})();var ie=d(15861);function Ge(n,l){if(1&n&&(e.TgZ(0,"ng-option",43),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.Q6J("value",t.id_akun),e.xp6(1),e.Oqu(t.nama_lengkap)}}function $e(n,l){1&n&&(e.TgZ(0,"div",44),e._uU(1," Akun Staff tidak boleh kosong "),e.qZA())}function We(n,l){1&n&&(e.TgZ(0,"div",44),e._uU(1," Kategori masuk tidak boleh kosong "),e.qZA())}function Ke(n,l){1&n&&(e.TgZ(0,"div",44),e._uU(1," Tanggal masuk tidak boleh kosong "),e.qZA())}function Ve(n,l){if(1&n&&(e.TgZ(0,"ng-option",43),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.Q6J("value",t.id_jadwal_sesi),e.xp6(1),e.Oqu(t.nama_sesi)}}function ze(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"tr",45),e.ynx(1,46),e.TgZ(2,"td",47),e._uU(3),e.qZA(),e.TgZ(4,"td",47),e._uU(5),e.qZA(),e.TgZ(6,"td",47)(7,"ng-select",48),e.NdJ("search",function(i){return e.CHM(t),e.oxw().prosesSelectDaftarRuang(i,"search")})("scrollToEnd",function(i){return e.CHM(t),e.oxw().prosesSelectDaftarRuang(i,"last_page")}),e.qZA()(),e.TgZ(8,"td",47),e._UZ(9,"timepicker",49),e.qZA(),e.TgZ(10,"td",47),e._UZ(11,"timepicker",50),e.qZA(),e.TgZ(12,"td",51)(13,"button",52),e.NdJ("click",function(){const s=e.CHM(t).index;return e.oxw().deleteDetailSesi(s)}),e._uU(14,"Hapus"),e.qZA()(),e.BQk(),e.qZA()}if(2&n){const t=l.$implicit,a=l.index,i=e.oxw();e.xp6(1),e.Q6J("formGroupName",a),e.xp6(2),e.Oqu(a+1),e.xp6(2),e.Oqu(t.value.nama_sesi),e.xp6(2),e.Q6J("virtualScroll",!0)("items",i.listDaftarRuang)("searchable",!0)("loading",i.loadingListDaftarRuang)("clearable",!0),e.xp6(2),e.Q6J("minuteStep",1)("showMeridian",!1),e.xp6(2),e.Q6J("minuteStep",1)("showMeridian",!1)}}function Xe(n,l){if(1&n&&(e.TgZ(0,"ul")(1,"li"),e._uU(2),e.qZA()()),2&n){const t=l.$implicit;e.xp6(2),e.AsE("",t.field," : ",t.message,"")}}function et(n,l){if(1&n&&(e.TgZ(0,"div",53),e._uU(1),e.YNc(2,Xe,3,2,"ul",54),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.errorMessage.metaData.message," "),e.xp6(1),e.Q6J("ngForOf",t.errorMessage.response)}}const tt=function(){return["Pengaturan Jadwal Staff"]},at=function(){return["../../view"]},it=function(){return{adaptivePosition:!0,dateInputFormat:"DD-MM-YYYY",returnFocusToInput:!0}},nt=function(n,l){return{"fa-spin fa-spinner pulse":n,"fa-check":l}},st=[{path:"",redirectTo:"view",pathMatch:"full"},{path:"view",component:Ce},{path:"add",component:Pe},{path:"edit/:id",component:(()=>{class n{constructor(t,a,i,s,r,u,_,bt){this.akunService=t,this.daftarRuangService=a,this.fb=i,this.jadwalSesiService=s,this.store=r,this.activatedRoute=u,this.spinner=_,this.JadwalStaffService=bt,this.listStaff=[],this.listDaftarRuang=[],this.listJadwalSesi=[],this.tglSekarang=new Date,this.minDate=new Date,this.loadingListStaff=!1,this.loadingListDaftarRuang=!1,this.loadingListJadwalSesi=!1,this.paramStaff={last_data:0,get_data:10,search:""},this.paramDaftarRuang={last_data:0,get_data:10,search:""},this.paramJadwalSesi={last_data:0,get_data:10,search:""},this.submitted=!1,this.id_jadwal_staff=null,this.getState=this.store.select("pengaturanJadwal_jadwalStaf")}ngOnInit(){var t=this;this.spinner.show("spinner1");let a=f().add(1,"days").format("DD-MM-YYYY");this.formInput=this.fb.group({id_akun_staff:[null,[c.kI.required]],tgl_masuk:[a,[c.kI.required]],kategori:[null,[c.kI.required]],id_jadwal_sesi:[null,[]],detail:this.fb.array([])}),this.prosesSelectStaff("","open"),this.prosesSelectDaftarRuang("","open"),setTimeout(()=>{this.activatedRoute.params.subscribe(i=>{i&&(this.id_jadwal_staff=i.id,this.JadwalStaffService.show(i.id).subscribe(function(){var s=(0,ie.Z)(function*(r){"0000"==r.metaData.response_code&&(yield t.prosesSelectStaff("",""),t.jadwalStaff=r.response,t.formInput.patchValue({id_akun_staff:t.jadwalStaff.id_akun_staff,kategori:t.jadwalStaff.kategori_jadwal,tgl_masuk:f(t.jadwalStaff.tgl_kegiatan,"YYYY-MM-DD").format("DD-MM-YYYY")}),t.listStaff=[{id_akun:t.jadwalStaff.id_akun_staff,nama_lengkap:t.jadwalStaff.nama_staff}],null!=t.jadwalStaff.detail&&t.jadwalStaff.detail.length>0&&t.jadwalStaff.detail.forEach(u=>{t.formInput.controls.detail.push(t.fb.group({id_jadwal_staff_detail:[u.id_jadwal_staff_detail,[]],id_jadwal_sesi:[u.id_jadwal_sesi,[]],nama_sesi:[u.nama_sesi,[]],id_ruang:[u.id_ruang,[]],jam_mulai:[t.parseTime(u.jam_mulai),[]],jam_selesai:[t.parseTime(u.jam_selesai),[]]}))})),t.spinner.hide("spinner1")});return function(r){return s.apply(this,arguments)}}()))})},400)}onFocus(t){document.getElementById(t).click()}SubmitForm(){var t=this;return(0,ie.Z)(function*(){if(t.submitted=!1,setTimeout(()=>{t.submitted=!0},200),t.formInput.invalid)return!1;t.spinner.show("spinner1");let a=Array();t.formInput.value.detail.forEach(s=>{a.push({id_jadwal_staff_detail:s.id_jadwal_staff_detail,id_jadwal_sesi:s.id_jadwal_sesi,jam_mulai:f(s.jam_mulai).format("HH:mm:ss"),jam_selesai:f(s.jam_selesai).format("HH:mm:ss"),id_ruang:s.id_ruang.toString()})});let i={tgl_kegiatan:f(t.formInput.value.tgl_masuk,"DD-MM-YYYY").format("YYYY-MM-DD"),detail:a,id_jadwal_staff:t.id_jadwal_staff};t.store.dispatch(M({payload:i})),setTimeout(()=>{t.spinner.hide("spinner1")},400)})()}simpanDetailSesi(){let t=this.formInput.value.id_jadwal_sesi;if(t){let a=this.listJadwalSesi.findIndex(i=>i.id_jadwal_sesi==t);if(a>=0){let i=this.listJadwalSesi[a];this.formInput.controls.detail.push(this.fb.group({id_jadwal_sesi:[i.id_jadwal_sesi,[]],nama_sesi:[i.nama_sesi,[]],id_ruang:[i.id_ruang,[]],jam_mulai:[new Date(""),[]],jam_selesai:[new Date(""),[]]}))}}}deleteDetailSesi(t){this.formInput.controls.detail.controls.splice(t,1)}prosesSelectStaff(t,a){this.loadingListStaff=!0;let i=this.paramStaff;"search"==a?(this.listJadwalSesi=[],i.search=t.term,i.last_data=0):i.search="",i.last_data="last_page"==a?i.last_data+i.get_data:0,this.akunService.prosesSelectAkun(i,a,"staff").subscribe(s=>{this.loadingListStaff=!1,s&&(0==this.listStaff.length?this.listStaff=s.response:s.response.map(r=>{this.listStaff.findIndex(_=>_.id_akun_staff==r.id_akun_staff)<0&&this.listStaff.push(r)}))},s=>{this.loadingListStaff=!1})}prosesSelectDaftarRuang(t,a){this.loadingListDaftarRuang=!0;let i=this.paramDaftarRuang;"search"==a?(this.listDaftarRuang=[],i.search=t.term,i.last_data=0):i.search="",i.last_data="last_page"==a?i.last_data+i.get_data:0,this.daftarRuangService.prosesSelectDaftarRuang(i,a).subscribe(s=>{this.loadingListDaftarRuang=!1,s&&(0==this.listDaftarRuang.length?this.listDaftarRuang=s.response:s.response.map(r=>{this.listDaftarRuang.findIndex(_=>_.id_ruang==r.id_ruang)<0&&this.listDaftarRuang.push(r)}))},s=>{this.loadingListDaftarRuang=!1})}parseTime(t){var a=new Date,i=t.match(/(\d+)(?::(\d\d))?\s*(p?)/);return a.setHours(parseInt(i[1])+(i[3]?12:0)),a.setMinutes(parseInt(i[2])||0),a}prosesSelectJadwalSesi(t,a){this.loadingListJadwalSesi=!0;let i=this.paramJadwalSesi;"search"==a?(this.listJadwalSesi=[],i.search=t.term,i.last_data=0):i.search="",i.last_data="last_page"==a?i.last_data+i.get_data:0,this.jadwalSesiService.prosesSelectJadwalSesi(i,a).subscribe(s=>{this.loadingListJadwalSesi=!1,this.listJadwalSesi=[],s&&(0==this.listJadwalSesi.length?s.response.forEach(r=>{this.listJadwalSesi.push({id_jadwal_sesi:r.id_jadwal_sesi,nama_sesi:r.nama_sesi+" ("+f(this.parseTime(r.jam_buka)).format("HH:mm")+" - "+f(this.parseTime(r.jam_tutup)).format("HH:mm")+")"})}):s.response.map(r=>{this.listJadwalSesi.findIndex(_=>_.id_jadwal_sesi==r.id_jadwal_sesi)<0&&this.listJadwalSesi.push({id_jadwal_sesi:r.id_jadwal_sesi,nama_sesi:r.nama_sesi+" ("+f(this.parseTime(r.jam_buka)).format("HH:mm")+" - "+f(this.parseTime(r.jam_tutup)).format("HH:mm")+")"})}))},s=>{this.loadingListJadwalSesi=!1})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(X.f),e.Y36(ee.d),e.Y36(c.qu),e.Y36(te.l),e.Y36(o.yh),e.Y36(S.gz),e.Y36(w.t2),e.Y36(H))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-edit"]],decls:79,vars:39,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","items","active_item"],[1,"text-center","mb-4"],[1,"row","clearfix"],[1,"col-xs-12","col-sm-12","col-md-12","col-lg-12"],["type","button",1,"btn","btn-kembali","btn-lg","mb-3",3,"routerLink"],[1,"fas","fa-arrow-left"],[1,"card"],[3,"formGroup","submit"],[1,"header"],[1,"body"],[1,"row","mb-3"],[1,"col-sm-2","col-form-label","fw-bold"],[1,"col-sm-9"],["bindLabel","nama_lengkap","bindValue","id_akun","placeholder","Pilih akun staff","formControlName","id_akun_staff",2,"flex","1 1 auto",3,"virtualScroll","searchable","loading","clearable","search","scrollToEnd"],[3,"value",4,"ngFor","ngForOf"],["class","form-text text-danger",4,"ngIf"],["placeholder","Pilih kategori","formControlName","kategori",1,"form-control"],["value","masuk"],["value","libur"],[1,"input-group"],["type","text","bsDatepicker","","formControlName","tgl_masuk","placeholder","Tanggal Masuk","id","tgl2",1,"form-control",3,"bsConfig","outsideClick","minDate"],[1,"input-group-text",2,"cursor","pointer","background","white","border-left","0px",3,"click"],[1,"fa","fa-calendar"],[1,"col-sm-4"],["bindLabel","nama_sesi","bindValue","id_jadwal_sesi","placeholder","Pilih jadwal sesi","formControlName","id_jadwal_sesi",2,"flex","1 1 auto",3,"virtualScroll","searchable","loading","clearable","search","scrollToEnd","open"],[1,"col-sm-2"],["type","button",1,"btn","btn-simpan",3,"click"],[1,"fa","fa-plus"],[1,"m-3","row"],[1,"table","tabl-sm","table-striped","table-bordered","table-sm"],[1,"pb-3"],["width","150"],["formArrayName","detail",4,"ngFor","ngForOf"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"footer"],[1,"text-center","mb-3"],["type","submit","color","primary",1,"btn","btn-simpan","btn-lg",3,"disabled"],[1,"fa",3,"ngClass"],["bdColor","rgba(0, 0, 0, 0.8)","size","medium","color","#fff","type","ball-clip-rotate-multiple",3,"name","fullScreen"],[2,"color","white"],[3,"value"],[1,"form-text","text-danger"],["formArrayName","detail"],[3,"formGroupName"],[1,"p-3",2,"vertical-align","top"],["bindLabel","nama_ruang","bindValue","id_ruang","placeholder","Pilih daftar ruang","formControlName","id_ruang",2,"flex","1 1 auto",3,"virtualScroll","items","searchable","loading","clearable","search","scrollToEnd"],["formControlName","jam_mulai",3,"minuteStep","showMeridian"],["formControlName","jam_selesai",3,"minuteStep","showMeridian"],[1,"p-3"],["type","button",1,"btn","btn-hapus",3,"click"],["role","alert",1,"alert","alert-danger"],[4,"ngFor","ngForOf"]],template:function(t,a){1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2),e._UZ(3,"app-breadcrumb",3),e.qZA(),e.TgZ(4,"h3",4),e._uU(5,"Edit Pengaturan Jadwal Staff"),e.qZA(),e.TgZ(6,"div",5)(7,"div",6)(8,"button",7),e._UZ(9,"i",8),e._uU(10," Kembali"),e.qZA(),e.TgZ(11,"div",9)(12,"form",10),e.NdJ("submit",function(){return a.SubmitForm()}),e._UZ(13,"div",11),e.TgZ(14,"div",12)(15,"div",13)(16,"label",14),e._uU(17,"Staff *"),e.qZA(),e.TgZ(18,"div",15)(19,"ng-select",16),e.NdJ("search",function(s){return a.prosesSelectStaff(s,"search")})("scrollToEnd",function(s){return a.prosesSelectStaff(s,"last_page")}),e.YNc(20,Ge,2,2,"ng-option",17),e.qZA(),e.YNc(21,$e,2,0,"div",18),e.qZA()(),e.TgZ(22,"div",13)(23,"label",14),e._uU(24,"Kategori *"),e.qZA(),e.TgZ(25,"div",15)(26,"select",19)(27,"option",20),e._uU(28,"Masuk"),e.qZA(),e.TgZ(29,"option",21),e._uU(30,"Libur"),e.qZA()(),e.YNc(31,We,2,0,"div",18),e.qZA()(),e.TgZ(32,"div",13)(33,"label",14),e._uU(34,"Tgl Awal *"),e.qZA(),e.TgZ(35,"div",15)(36,"div",22),e._UZ(37,"input",23),e.TgZ(38,"span",24),e.NdJ("click",function(){return a.onFocus("tgl2")}),e._UZ(39,"i",25),e.qZA()(),e.YNc(40,Ke,2,0,"div",18),e.qZA()(),e.TgZ(41,"div",13)(42,"label",14),e._uU(43,"Jadwal Sesi"),e.qZA(),e.TgZ(44,"div",26)(45,"ng-select",27),e.NdJ("search",function(s){return a.prosesSelectJadwalSesi(s,"search")})("scrollToEnd",function(s){return a.prosesSelectJadwalSesi(s,"last_page")})("open",function(s){return a.prosesSelectJadwalSesi(s,"open")}),e.YNc(46,Ve,2,2,"ng-option",17),e.qZA()(),e.TgZ(47,"div",28)(48,"button",29),e.NdJ("click",function(){return a.simpanDetailSesi()}),e._UZ(49,"i",30),e._uU(50," Tambah"),e.qZA()()(),e.TgZ(51,"div",31)(52,"table",32)(53,"thead",33)(54,"tr")(55,"th"),e._uU(56,"No"),e.qZA(),e.TgZ(57,"th"),e._uU(58,"Nama Jadwal Sesi"),e.qZA(),e.TgZ(59,"th",34),e._uU(60,"Ruangan"),e.qZA(),e.TgZ(61,"th"),e._uU(62,"Jam Mulai"),e.qZA(),e.TgZ(63,"th"),e._uU(64,"Jam Selesai"),e.qZA(),e.TgZ(65,"th"),e._uU(66,"Aksi"),e.qZA()()(),e.TgZ(67,"tbody"),e.YNc(68,ze,15,12,"tr",35),e.qZA()()(),e.TgZ(69,"div",13),e.YNc(70,et,3,2,"div",36),e.qZA()(),e.TgZ(71,"div",37)(72,"div",38)(73,"button",39),e._UZ(74,"i",40),e._uU(75," Simpan "),e.qZA()()()()()()(),e.TgZ(76,"ngx-spinner",41)(77,"p",42),e._uU(78," Loading... "),e.qZA()()()()),2&t&&(e.xp6(3),e.Q6J("title","Pengaturan Jadwal")("items",e.DdM(33,tt))("active_item","Edit Pengaturan Jadwal Staff"),e.xp6(5),e.Q6J("routerLink",e.DdM(34,at)),e.xp6(4),e.Q6J("formGroup",a.formInput),e.xp6(7),e.ekj("border-danger",a.formInput.controls.id_akun_staff.hasError("required")&&a.submitted),e.Q6J("virtualScroll",!0)("searchable",!0)("loading",a.loadingListStaff)("clearable",!0),e.xp6(1),e.Q6J("ngForOf",a.listStaff),e.xp6(1),e.Q6J("ngIf",a.formInput.controls.id_akun_staff.hasError("required")&&a.submitted),e.xp6(5),e.ekj("border-danger",a.formInput.controls.kategori.hasError("required")&&a.submitted),e.xp6(5),e.Q6J("ngIf",a.formInput.controls.kategori.hasError("required")&&a.submitted),e.xp6(6),e.ekj("border-danger",a.formInput.controls.tgl_masuk.hasError("required")&&a.submitted),e.Q6J("bsConfig",e.DdM(35,it))("outsideClick",!0)("minDate",a.minDate),e.xp6(3),e.Q6J("ngIf",a.formInput.controls.tgl_masuk.hasError("required")&&a.submitted),e.xp6(5),e.Q6J("virtualScroll",!0)("searchable",!0)("loading",a.loadingListJadwalSesi)("clearable",!0),e.xp6(1),e.Q6J("ngForOf",a.listJadwalSesi),e.xp6(22),e.Q6J("ngForOf",a.formInput.get("detail").controls),e.xp6(2),e.Q6J("ngIf",null!=a.errorMessage),e.xp6(3),e.Q6J("disabled",a.isLoadingButton),e.xp6(1),e.Q6J("ngClass",e.WLB(36,nt,a.isLoadingButton,!a.isLoadingButton)),e.xp6(2),e.Q6J("name","spinner1")("fullScreen",!0))},directives:[Q.L,S.rH,c._Y,c.JL,c.sg,A.w9,c.JJ,c.u,v.sg,A.jq,v.O5,c.EJ,c.YN,c.Kr,D.Y5,c.Fj,D.Np,c.CE,c.x0,G.EV,v.mk,w.Ro],styles:[""]}),n})()}];let rt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[S.Bz.forChild(st)],S.Bz]}),n})();var lt=d(60795),ot=d(16270),p=d(36642),J=d(63900),y=d(54004),U=d(70262),ne=d(18505),j=d(39646);let dt=(()=>{class n{constructor(t,a,i){this.actions$=t,this.jadwalStafService=a,this.router=i,this.urlBacktoView=["pengaturan-jadwal","pengaturan-jadwal-staf","view"],this.Toast=b().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:s=>{s.addEventListener("mouseenter",b().stopTimer),s.addEventListener("mouseleave",b().resumeTimer)}}),this.addInitial$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(I),(0,J.w)(s=>this.jadwalStafService.insert(s.payload).pipe((0,y.U)(r=>E({payload:r.response})),(0,U.K)(r=>(0,j.of)(L({message:r}))))))),this.addSuccess$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(E),(0,ne.b)(s=>{b().fire({title:"Data berhasil disimpan",icon:"success",showCancelButton:!1,allowOutsideClick:!1,confirmButtonText:"Ya, lanjutkan!"}).then(r=>{this.router.navigate(this.urlBacktoView)})})),{dispatch:!1}),this.addFailure$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(L)),{dispatch:!1}),this.updateInitial$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(M),(0,J.w)(s=>this.jadwalStafService.update(s.payload.id_jadwal_staff,s.payload).pipe((0,y.U)(r=>Y({payload:r.response})),(0,U.K)(r=>(0,j.of)(q({message:r}))))))),this.updateSuccess$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(Y),(0,ne.b)(s=>{b().fire({title:"Data berhasil disimpan",icon:"success",showCancelButton:!1,allowOutsideClick:!1,confirmButtonText:"Ya, lanjutkan!"}).then(r=>{this.router.navigate(this.urlBacktoView)})})),{dispatch:!1}),this.updateFailure$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(q)),{dispatch:!1}),this.getByIdInitial$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(K),(0,J.w)(s=>this.jadwalStafService.show(s.payload.id).pipe((0,y.U)(r=>V({payload:r.response})),(0,U.K)(r=>(0,j.of)(N({message:r}))))))),this.getByIdFailure$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(N)),{dispatch:!1}),this.deleteInitial$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(O),(0,J.w)(s=>this.jadwalStafService.delete(s.id,s.payload).pipe((0,y.U)(r=>F({payload:r.response})),(0,U.K)(r=>(0,j.of)(B({message:r}))))))),this.deleteSuccess$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(F),(0,y.U)(s=>(this.Toast.fire({icon:"success",title:"Data berhasil dihapus"}),z())))),this.deleteFailure$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(B)),{dispatch:!1})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(p.eX),e.LFG(H),e.LFG(S.F0))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();const ct=(0,o.Lq)({jadwalStaf:null,isLoadingButton:!1,errorMessage:null,reloadTable:!1,submitButton:!1,isEdit:!1},(0,o.on)(I,(n,l)=>Object.assign(Object.assign({},n),{isLoadingButton:!0,isEdit:!1,reloadTable:!1})),(0,o.on)(E,(n,l)=>Object.assign(Object.assign({},n),{isLoadingButton:!1,jadwalStaf:l.payload,errorMessage:null})),(0,o.on)(L,(n,l)=>Object.assign(Object.assign({},n),{isLoadingButton:!1,errorMessage:l.message,isEdit:!1,reloadTable:!1})),(0,o.on)(M,(n,l)=>Object.assign(Object.assign({},n),{isLoadingButton:!0,errorMessage:null,isEdit:!1,reloadTable:!1})),(0,o.on)(Y,(n,l)=>Object.assign(Object.assign({},n),{isLoadingButton:!1,jadwalStaf:l.payload,isEdit:!1,reloadTable:!1})),(0,o.on)(q,(n,l)=>Object.assign(Object.assign({},n),{isLoadingButton:!1,errorMessage:l.message,isEdit:!1,reloadTable:!1})),(0,o.on)(K,(n,l)=>Object.assign(Object.assign({},n),{isLoadingButton:!1,errorMessage:null,jadwalStaf:new Z})),(0,o.on)(V,(n,l)=>Object.assign(Object.assign({},n),{isLoadingButton:!1,errorMessage:null,isEdit:!0,jadwalStaf:l.payload,reloadTable:!1})),(0,o.on)(N,(n,l)=>Object.assign(Object.assign({},n),{isLoadingButton:!1,errorMessage:l.message,isEdit:!1,reloadTable:!1})),(0,o.on)(O,(n,l)=>Object.assign(Object.assign({},n),{isLoadingButton:!1,errorMessage:null,isEdit:!1,reloadTable:!1,jadwalStaf:new Z})),(0,o.on)(F,(n,l)=>Object.assign(Object.assign({},n),{isLoadingButton:!1,errorMessage:null,isEdit:!1,reloadTable:!0})),(0,o.on)(B,(n,l)=>Object.assign(Object.assign({},n),{isLoadingButton:!1,errorMessage:l.message,isEdit:!1,reloadTable:!1})),(0,o.on)(z,(n,l)=>Object.assign(Object.assign({},n),{reloadTable:!0})),(0,o.on)(be,(n,l)=>Object.assign(Object.assign({},n),{jadwalStaf:new Z,errorMessage:null,isEdit:!1,reloadTable:!1,isLoadingButton:!1})));function ft(n,l){return ct(n,l)}var pt=d(13559),mt=d(21178),gt=d(37183),_t=d(24130);P.z1U.registerPlugins([pt.ZP,mt.ZP,gt.Z,_t.ZP]);let ht=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[v.ez,w.ef,rt,lt.K,c.u5,c.UX,P.z1U,T.T,ot.z,A.A0,D.kn.forRoot(),G.Db.forRoot(),o.Aw.forFeature("pengaturanJadwal_jadwalStaf",ft),p.sQ.forFeature([dt])]]}),n})()}}]);